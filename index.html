<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>æˆ‘å€‘çš„æ„›æƒ…æ•…äº‹</title>

  <!-- åˆ†äº«å¡ç‰‡èˆ‡ icon -->
  <meta property="og:description" content="æˆ‘å€‘çš„æ„›æƒ…æ•…äº‹èˆ‡å…±åŒå›æ†¶ã€‚" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="images/16.jpg" />
  <meta property="og:locale" content="zh_TW" />
  <link rel="icon" href="images/4.jpg" />

  <style>
    :root{
      --bg: #ffffff;
      --text: #222;
      --muted: #666;
      --brand: #e91e63;
      --brand-weak: #fce4ec;
      --card: #ffffff;
      --shadow: rgba(0,0,0,.08);
    }
    :root.dark{
      --bg:#121212; --text:#eaeaea; --muted:#b5b5b5;
      --brand:#ff5c8a; --brand-weak:#2a1620; --card:#1a1a1a; --shadow:rgba(0,0,0,.4);
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans TC",Arial,sans-serif;line-height:1.7;background:var(--bg);color:var(--text)}
    .container{max-width:960px;margin:0 auto;padding:0 20px}
    .site-header{background:linear-gradient(180deg,var(--brand) 0%, #d81b60 100%);color:#fff;padding:48px 0 40px;text-align:center}
    .site-title{margin:0 0 8px;font-weight:800;letter-spacing:1px}
    .lead{margin:0;font-size:1.05rem;opacity:.95}
    main.container{padding:24px 0 48px}
    .card{background:var(--card);border-radius:16px;box-shadow:0 6px 20px var(--shadow);padding:20px;margin:16px 0}
    .sub{color:var(--muted);margin-top:-4px}
    .gallery{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:12px;margin-top:12px}
    .g-item{display:block;border-radius:12px;overflow:hidden}
    .g-item img{width:100%;height:180px;object-fit:cover;display:block;transition:transform .25s ease}
    .g-item:focus img,.g-item:hover img{transform:scale(1.03)}
    .anniv-list{list-style:none;padding:0;margin:8px 0 0}
    .anniv-list li{padding:10px 12px;border-left:4px solid var(--brand);background:var(--brand-weak);border-radius:8px;margin:8px 0}
    textarea{width:100%;border:1px solid #ddd;background:var(--bg);color:var(--text);border-radius:12px;padding:12px 14px;resize:vertical}
    .actions{display:flex;gap:8px;align-items:center;margin-top:10px;flex-wrap:wrap}
    .btn{appearance:none;border:none;background:var(--brand);color:#fff;padding:8px 14px;border-radius:999px;cursor:pointer;font-weight:700}
    .btn-ghost{background:transparent;color:var(--brand);outline:2px solid var(--brand)}
    .save-status{color:var(--muted);font-size:.9rem}
    .lightbox{border:none;padding:0;background:transparent;max-width:90vw}
    .lightbox::backdrop{background:rgba(0,0,0,.65)}
    .lightbox img{max-width:90vw;max-height:80vh;border-radius:12px;display:block}
    .lightbox-close{position:fixed;top:20px;right:20px;font-size:28px;width:40px;height:40px;border-radius:50%;border:none;cursor:pointer}
    .site-footer{text-align:center;padding:24px 0 48px;color:var(--muted)}
    @media (prefers-reduced-motion: reduce){*{transition:none!important;animation:none!important}}
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container">
      <h1 class="site-title">æˆ‘å€‘çš„æ„›æƒ…æ•…äº‹</h1>
      <p class="lead">
        å¾ <time id="start-date" data-start="2025-01-09">2025-01-09</time> é–‹å§‹ï¼Œ
        æˆ‘å€‘å·²ç¶“ä¸€èµ·èµ°é <span id="day-counter">0</span> å¤© â¤
      </p>
    </div>
  </header>

  <main class="container">
    <section class="card" aria-labelledby="photos-title">
      <h2 id="photos-title">ç…§ç‰‡å›é¡§</h2>
      <p class="sub">é»åœ–ç‰‡å¯æ”¾å¤§ç€è¦½</p>
      <div class="gallery" id="gallery">
      
      </div>
    </section>
<!-- å€’æ•¸ï¼šä¸‹ä¸€å€‹ç´€å¿µæ—¥ -->
<section class="card" aria-labelledby="countdown-title">
  <h2 id="countdown-title">ä¸‹ä¸€å€‹ç´€å¿µæ—¥å€’æ•¸</h2>
  <p class="sub">è·é›¢ <strong id="next-anniv-name">â€”</strong> é‚„æœ‰</p>
  <p style="font-size:2rem;margin:.25rem 0;"><span id="next-anniv-days">â€”</span> å¤©</p>
  <p class="sub">æ—¥æœŸï¼š<span id="next-anniv-date">â€”</span></p>
</section>

<!-- æŠ½å¡ï¼šéš¨æ©Ÿå›æ†¶ -->
<section class="card" aria-labelledby="draw-title">
  <h2 id="draw-title">æŠ½ä¸€å¼µå›æ†¶</h2>
  <div class="actions">
    <button id="draw-btn" class="btn">æŠ½å¡ï¼</button>
    <span class="sub">éš¨æ©Ÿå›æ†¶</span>
  </div>
  <div id="draw-result" style="margin-top:12px">
    <img id="draw-img" alt="éš¨æ©Ÿå›æ†¶" style="max-width:100%;border-radius:12px;display:none">
    <p id="draw-caption" class="sub" style="margin-top:8px"></p>
  </div>
</section>
    <section class="card" aria-labelledby="anniv-title">
      <h2 id="anniv-title">é‡è¦ç´€å¿µæ—¥</h2>
      <ul id="anniv-list" class="anniv-list" aria-live="polite"></ul>
    </section>

    <!-- Email å¯„é€è¡¨å–® -->
<section class="card" aria-labelledby="mail-title">
  <h2 id="mail-title">å¯„ä¸€å°å°ä¿¡çµ¦ä½  â¤</h2>
  <form id="love-form" action="*" method="POST">
    <input type="text" name="name" placeholder="ä½ çš„åå­—" required
           style="padding:8px 12px;border-radius:10px;border:1px solid #ddd;margin:5px 0;display:block;width:100%">
    <input type="email" name="_replyto" placeholder="ä½ çš„Emailï¼ˆå›ä¿¡ç”¨ï¼‰" required
           style="padding:8px 12px;border-radius:10px;border:1px solid #ddd;margin:5px 0;display:block;width:100%">
    <textarea name="message" placeholder="æƒ³èªªçš„è©±â€¦" required rows="4"
              style="padding:8px 12px;border-radius:10px;border:1px solid #ddd;margin:5px 0;display:block;width:100%"></textarea>
    <button type="submit" class="btn">é€å‡º</button>
  </form>
  <p id="form-status" class="sub" style="margin-top:8px"></p>
</section>

  </main>

  <footer class="site-footer">
    <div class="container">
      <p>ç‚ºæˆ‘å€‘è£½ä½œ by <span id="author">Us</span> Â· <a href="#" id="toggle-theme">åˆ‡æ›ä¸»é¡Œ</a></p>
    </div>
  </footer>

  <dialog id="lightbox" class="lightbox" aria-label="åœ–ç‰‡é è¦½">
    <img id="lightbox-img" alt="æ”¾å¤§åœ–ç‰‡" />
    <button id="lightbox-close" class="lightbox-close" aria-label="é—œé–‰">Ã—</button>
  </dialog>

  <script>
  (function () {
  // ===== åŸºæœ¬è¨­å®š =====
  const TOTAL_PHOTOS = 16; // æŠ½å¡ç”¨çš„ç¸½æ•¸ï¼ˆ1.jpg ~ 16.jpgï¼‰
  const CAPTIONS = {
    "images/2.jpg": "ç¬¬ä¸€æ¬¡æ—…è¡Œåˆç…§",
    "images/5.jpg": "ç”Ÿæ—¥ç´€å¿µæ—¥",
    "images/11.jpg": "è–èª•ç¯€äº¤æ›ç¦®ç‰©"
  };
  const ANNIVERSARIES = [
    { date: "2025-01-09", title: "åœ¨ä¸€èµ·" },
    { date: "2025-02-14", title: "æƒ…äººç¯€" },
    { date: "2025-05-20", title: "520" },
    { date: "2025-12-25", title: "è–èª•ç¯€" }
  ];

  // ===== å°å·¥å…· =====
  const $  = (sel, root=document) => root.querySelector(sel);
  const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));
  const pad2 = n => (n<10 ? "0"+n : ""+n);

  // ===== å¤©æ•¸è¨ˆç®— =====
  (function () {
    const el = $("#start-date");
    if (!el) return;
    const start = new Date((el.getAttribute("data-start") || el.textContent.trim()) + "T00:00:00");
    const today = new Date();
    const days = Math.floor((today - start) / (1000*60*60*24));
    $("#day-counter").textContent = String(days);
  })();

  // ===== ç›¸ç°¿è‡ªå‹•è¼‰å…¥ï¼ˆä½ åˆ»æ„ç”¨ 5~12ï¼Œä¿ç•™ï¼‰ =====
  (function () {
    const g = $("#gallery");
    if (!g) return;
    const fr = document.createDocumentFragment();
    for (let i = 5; i <= 12; i++) {
      const path = `images/${i}.jpg`;
      const a = document.createElement("a");
      a.href = path;
      a.className = "g-item";
      const img = document.createElement("img");
      img.src = path;
      img.alt = CAPTIONS[path] || `å›æ†¶ç…§ç‰‡ ${i}`;
      img.loading = "lazy";
      a.appendChild(img);
      fr.appendChild(a);
    }
    g.appendChild(fr);
  })();

  // ===== ç´€å¿µæ—¥æ¸²æŸ“ =====
  (function () {
    const list = $("#anniv-list");
    if (!list) return;
    ANNIVERSARIES
      .slice().sort((a,b)=>a.date.localeCompare(b.date))
      .forEach(x => {
        const li = document.createElement("li");
        li.textContent = `${x.date}ï¼š${x.title}`;
        list.appendChild(li);
      });
  })();

  // ===== ä¸‹ä¸€å€‹ç´€å¿µæ—¥å€’æ•¸ =====
  (function () {
    const nameEl = $("#next-anniv-name");
    const daysEl = $("#next-anniv-days");
    const dateEl = $("#next-anniv-date");
    if (!nameEl || !daysEl || !dateEl) return;

    const today = new Date();
    const candidates = ANNIVERSARIES.map(a => {
      const [,m,d] = a.date.split("-").map(Number);
      const thisYear = new Date(today.getFullYear(), m-1, d);
      const nextYear = new Date(today.getFullYear()+1, m-1, d);
      const target = (thisYear >= new Date(today.getFullYear(), today.getMonth(), today.getDate())) ? thisYear : nextYear;
      return { title: a.title, date: target };
    }).sort((x,y)=> x.date - y.date);

    const next = candidates[0];
    const diffDays = Math.ceil((next.date - today) / (1000*60*60*24));
    nameEl.textContent = next.title;
    dateEl.textContent = `${next.date.getFullYear()}-${pad2(next.date.getMonth()+1)}-${pad2(next.date.getDate())}`;
    daysEl.textContent = diffDays;
  })();

  // ===== ç‡ˆç®±ï¼ˆå·¦å³åˆ‡æ›ï¼‰ =====
  (function () {
    const lightbox = $("#lightbox");
    const lightboxImg = $("#lightbox-img");
    const closeBtn = $("#lightbox-close");
    let currentIndex = -1;

    const items = $$("#gallery a.g-item");
    const openAt = (idx) => {
      currentIndex = (idx + items.length) % items.length;
      const href = items[currentIndex].getAttribute("href");
      lightboxImg.src = href;
      if (typeof lightbox.showModal === "function") lightbox.showModal();
      else lightbox.setAttribute("open","");
    };

    items.forEach((a, idx) => {
      a.addEventListener("click", e => { e.preventDefault(); openAt(idx); });
    });
    closeBtn.addEventListener("click", () => lightbox.close());
    lightbox.addEventListener("click", e => { if (e.target === lightbox) lightbox.close(); });
    document.addEventListener("keydown", e => {
      if (!lightbox.open) return;
      if (e.key === "Escape") lightbox.close();
      if (e.key === "ArrowRight") openAt(currentIndex+1);
      if (e.key === "ArrowLeft") openAt(currentIndex-1);
    });
  })();

  // ===== æŠ½å¡ï¼ˆå¾ 1.jpg ~ TOTAL_PHOTOS.jpg éš¨æ©ŸæŠ½ï¼‰ =====
  (function () {
    const btn = $("#draw-btn");
    const img = $("#draw-img");
    const cap = $("#draw-caption");
    if (!btn || !img || !cap) return;

    const pool = Array.from({length: TOTAL_PHOTOS}, (_,i)=> `images/${i+1}.jpg`);
    const draw = () => {
      const pick = pool[Math.floor(Math.random() * pool.length)];
      img.src = pick;
      img.style.display = "block";
      cap.textContent = CAPTIONS[pick] || "å°å°çš„å›æ†¶ç‰‡æ®µ";
    };
    btn.addEventListener("click", draw);
  })();

  // ===== ä¸»é¡Œåˆ‡æ› =====
  (function(){
    const KEY='our-theme';
    const apply = mode => document.documentElement.classList.toggle('dark', mode==='dark');
    const saved = localStorage.getItem(KEY);
    if(saved) apply(saved);
    const toggle = $('#toggle-theme');
    if (toggle) {
      toggle.addEventListener('click', e=>{
        e.preventDefault();
        const nowDark = !document.documentElement.classList.contains('dark');
        const mode = nowDark ? 'dark' : 'light';
        apply(mode); localStorage.setItem(KEY, mode);
      });
    }
  })();
})();

// ===== å¯„ä¿¡ (Formspree) =====
(function(){
  const form = document.getElementById("love-form");
  const status = document.getElementById("form-status");

  if(form){
    form.addEventListener("submit", async function(e){
      e.preventDefault();
      if (form.action === "*" || !form.action.startsWith("https://")) {
        status.textContent = "è«‹å…ˆæŠŠ form action æ›æˆä½ çš„ Formspree endpoint æ‰èƒ½å¯„ä¿¡ã€‚";
        return;
      }
      const data = new FormData(form);
      try {
        const res = await fetch(form.action, {
          method: form.method || "POST",
          body: data,
          headers: { 'Accept': 'application/json' }
        });
        if(res.ok){
          status.textContent = "å¯„é€æˆåŠŸï¼ğŸ’Œ";
          form.reset();
        } else {
          status.textContent = "å¯„é€å¤±æ•—ï¼Œè«‹å†è©¦ä¸€æ¬¡ã€‚";
        }
      } catch(err){
        status.textContent = "å¯„é€éŒ¯èª¤ï¼š" + err.message;
      }
    });
  }
})();

  </script>
</body>
</html>
